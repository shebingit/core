<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>ALTOS CORE</title>
  <!-- plugins:css -->
  <link rel="stylesheet" href="{% static 'assets/vendors/mdi/css/materialdesignicons.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/vendors/css/vendor.bundle.base.css' %}">
  <!-- endinject -->
  <!-- Plugin css for this page -->
  <link rel="stylesheet" href="{% static 'assets/vendors/jvectormap/jquery-jvectormap.css' %}">
  <link rel="stylesheet" href="{% static 'assets/vendors/flag-icon-css/css/flag-icon.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/vendors/owl-carousel-2/owl.carousel.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/vendors/owl-carousel-2/owl.theme.default.min.css' %}">
  <!-- End plugin css for this page -->
  <!-- inject:css -->
  <!-- endinject -->
  <!-- Layout styles -->
  <link rel="stylesheet" href="{% static 'assets/css/style.css' %}">
  <!-- End layout styles -->
  <link rel="shortcut icon" href="{% static 'assets/images/favicon.png' %}" />
  <script src="{% static 'assets/vendors/js/vendor.bundle.base.js'%}"></script> 
  <script src="{% static 'assets/vendors/chart.js/Chart.min.js'%}"></script>
  <script src="{% static 'assets/vendors/chart.js/Chart.min.js'%}"></script>
</head>
<body style="background-color: #2a3038;">
  <style>
    .text-left, #hf {
      font-family: rubik, sans-serif;
      color: white;
      font-weight: 500;
    }
  
    .ui-widget-content {
      border: none;
      background: #191c24;
      color: #636d87;
    }
  
    .ui-datepicker th {
      padding: 0.7em 0.3em;
      text-align: center;
      font-weight: bold;
      border: none;
      color: #636d87;
    }
  
    .ui-state-default,
    .ui-widget-content .ui-state-default,
    .ui-widget-header .ui-state-default,
    .ui-button,
    html .ui-button.ui-state-disabled:hover,
    html .ui-button.ui-state-disabled:active {
      border: 1px solid #636d87;
      border-radius: 50%;
      background: #191c24;
      font-weight: normal;
      color: #636d87;
      text-align: center;
    }
  
    .ui-widget-header {
      border: 1px solid #636d87;
      background: #191c24;
      color: #636d87;
      font-weight: bold;
    }
  
    .ui-widget.ui-widget-content {
      border: 1px solid #636d87;
    }
  </style>
  <div class="container py-5">
    <div id="firstbox" class="row shadow " style="background-color: #191c24;">
      <div class="col-md-12 ">
        <h3 style="font-size: 25px;font-weight: 600;opacity: 0.9;color: #6c7293;padding-top: 1.5rem;padding-left: 2rem;">Apply Leave</h3>
        <form method="POST" action="{% url 'applyNewOtherLeave' %}" enctype="multipart/form-data" id="myForm" onsubmit="return validateForm()">
          {% csrf_token %}
          <div class="container mt-5 mb-5">
            <div class="row">
              <div class="col-md-4 col-lg-4">
                <div class="text-left mt-3 ">Name</div>
                <input type="text" name="full_name" class="form-control mt-2" style="border-radius:5px;" id="full_name" placeholder="Full Name.." autocomplete="off" required>
              </div>
              <div class="col-md-4">
                <div class="text-left mt-3 ">Email</div>
                <input type="email" name="email" class="form-control mt-2" onkeyup="validateEmail()" style="border-radius:5px;" id="email" placeholder="Email ID.." autocomplete="off" required>
                <div class="text-danger" style="font-size: 14px;" id="emailErr"></div>
              </div>
              <div class="col-md-4">
                <div class="text-left mt-3 ">Mobile</div>
                <input type="tel" name="mobile" class="form-control mt-2" onkeyup="validateMobile()" style="border-radius:5px;" id="mobile" placeholder="10 digit mobile number.." autocomplete="off" required>
                <div class="text-danger" style="font-size: 14px;" id="mobErr"></div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-6 col-lg-6">
                <div class="text-left mt-3 ">From</div>
                <input autocomplete="off" type="date" name="from" class="form-control mt-2 " style="border-radius:5px;"
                  id="from" onchange="myFunction()" placeholder="Leave From..." autocomplete="off" required>
              </div>
              <div class="col-md-6">
                <div class="text-left mt-3 ">To</div>
                <input autocomplete="off" type="date" name="to" class="form-control mt-2" style="border-radius:5px;"
                  id="to" onchange="myFunction()" placeholder="Leave To..." autocomplete="off" required>
              </div>
            </div>
            <div class="col pt-2" id="halful">
              <input type="radio" id="half" name="haful" value="half Day">
              <label id="hf">Half Day</label><br>
              <input type="radio" id="full" name="haful" value="full Day" checked="checked">
              <label id="hf">Full Day</label><br>
            </div>
            <div class="row">
              <div class="container">
                <div class="text-left mt-5 ">Reason</div>
                <textarea autocomplete="off" type="text" name="reason" class="form-control mt-2 "
                  style="border-radius:5px;height:90px;" id="reason" placeholder="Leave Reason" required></textarea>
              </div>
            </div>
            <div class=" row  mt-5 ">

              <div class="col-md-4 offset-5">
                <button type="submit" class="btn btn-primary ">Apply</button>
              </div>
        </form>
      </div>
    </div>
  </div>
  </div>


          <!-- container-scroller -->
        <!-- plugins:js -->

        <!-- bootsrtap for popup -->
      <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous"> -->
  <script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
  <!-- <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script> -->
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

  <script src="{% static 'assets/vendors/js/vendor.bundle.base.js' %}"></script> 
  <!-- endinject -->
  <!-- Plugin js for this page -->
  <script src="{% static 'assets/vendors/chart.js/Chart.min.js' %}"></script>
  <script src="{% static 'assets/vendors/progressbar.js/progressbar.min.js' %}"></script>
  <script src="{% static 'assets/vendors/jvectormap/jquery-jvectormap.min.js' %}"></script>
  <script src="{% static 'assets/vendors/jvectormap/jquery-jvectormap-world-mill-en.js' %}"></script>
  <script src="{% static 'assets/vendors/owl-carousel-2/owl.carousel.min.js' %}"></script>
  <script src="{% static 'assets/js/jquery.cookie.js" type="text/javascript' %}"></script>
  <!-- End plugin js for this page -->
  <!-- inject:js -->
  <script src="{% static 'assets/js/off-canvas.js' %}"></script>
  <script src="{% static 'assets/js/hoverable-collapse.js' %}"></script>
  <script src="{% static 'assets/js/misc.js' %}"></script>
  <script src="{% static 'assets/js/settings.js' %}"></script>
  <script src="{% static 'assets/js/todolist.js' %}"></script>
  <!-- endinject -->
  <!-- Custom js for this page -->
  <script src="{% static 'assets/js/dashboard.js' %}"></script>
  <!-- End custom js for this page -->
    <script src="{% static 'assets/vendors/js/vendor.bundle.base.js'%}"></script> 
  <!-- endinject -->

  <!-- inject:js -->
  <script src="{% static 'assets/js/chart.js'%}"></script>


  <script>

    document.getElementById("halful").style.display = "none";

    function myFunction() {
      var x = document.getElementById("from").value;
      var y = document.getElementById("to").value;
      if (x, y == '') {
        document.getElementById("halful").style.display = "none";
      }
      else if (x == y) {
        document.getElementById("halful").style.display = "block";
      }
      else {
        document.getElementById("halful").style.display = "none";
      }
    }
    $(document).on('click', '#btn-submit', function (e) {
      e.preventDefault();
      const swalWithBootstrapButtons = Swal.mixin({
        customClass: {
          confirmButton: 'btn btn-success',
          cancelButton: 'btn btn-danger'
        },
        buttonsStyling: true
      })

      swalWithBootstrapButtons.fire({
        title: 'Are you sure?',
        text: " Do you want to apply this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonText: 'Yes, apply Leave!',
        cancelButtonText: 'No, cancel!',
        reverseButtons: true,
        preConfirm: () => {
          if (document.getElementById('reason').value) {
            // Handle return value 
          } else {
            Swal.showValidationMessage('reason input missing')
          }
          if (document.getElementById('to').value) {
            // Handle return value 
          } else {
            Swal.showValidationMessage('to input missing')
          }
          if (document.getElementById('from').value) {
            // Handle return value 
          } else {
            Swal.showValidationMessage('from input missing')
          }
        }
      }).then((result) => {
        if (result.isConfirmed) {
          swalWithBootstrapButtons.fire(
            'Applied',
            'Your leave has been Applied.',
            'success'
          )
          $('#myForm').submit();
        } else if (
          result.dismiss === Swal.DismissReason.cancel
        ) {
          swalWithBootstrapButtons.fire(
            'Cancelled',
            'Your leave request cancelled',
            'error'
          )
        }
      })
    })
  </script>
  <script>
      $(function() {
          var date = new Date();
          var tdate = date.getDate();
          var month = date.getMonth()+1;
        
          if (tdate < 10){
              tdate = '0' + tdate;
          }

          if (month < 10){
              month = '0' + month;
          }
          var year = date.getUTCFullYear();
          var minDate= year + "-" + month + "-" +tdate;
          document.getElementById("from").setAttribute('min',minDate)

      })
  </script>
  <script>
    $(function() {
        var date = new Date();
        var tdate = date.getDate();
        var month = date.getMonth()+1;
      
        if (tdate < 10){
            tdate = '0' + tdate;
        }

        if (month < 10){
            month = '0' + month;
        }
        var year = date.getUTCFullYear();
        var minDate= year + "-" + month + "-" +tdate;
        document.getElementById("to").setAttribute('min',minDate)

    })
  </script>
<script>
  var start = document.getElementById('from');
  var end = document.getElementById('to');

  start.addEventListener('change', function() {
    if (start.value)
        end.min = start.value;
  }, false);
  end.addEventLiseter('change', function() {
    if (end.value)
        start.max = end.value;
  }, false);

  function validateForm(){
    var name = $('#full_name').val().trim();
    var email = $('#email').val().trim();
    var mobile = $('#mobile').val().trim();
    var reason = $('#reason').val().trim();

    var nameRegex = /^[a-zA-Z]+(\s[a-zA-Z]+)*$/;
    var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    var phoneRegex = /^\d{10}$/;

    if(name != ""){
      if(! nameRegex.test(name)){
        alert('Please Enter a valid Full Name..!')
        return false;
      }
    }

    if(email != ""){
      if(! emailRegex.test(email)){
        alert('Please Enter a valid Email Address..!')
        return false;
      }
    }

    if(mobile != ""){
      if(! phoneRegex.test(mobile)){
        alert('Please Enter a valid 10 digit mobile number..!')
        return false;
      }
    }

    if(reason == ""){
      alert('Please enter a reason to take leave.!')
      return false;
    }

    return true;
  }


  function validateEmail(){
    var email = $('#email').val().trim();
    var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if(email != ""){
      if(! emailRegex.test(email)){
        $("#emailErr").text('Enter a valid Email Address')
      }else{
        $("#emailErr").text('')
      }
    }
  }

  function validateMobile(){
    var mobile = $('#mobile').val().trim();
    var phoneRegex = /^\d{10}$/;

    let value = mobile.replace(/\D/g, ''); // Remove non-numeric characters
    if (value.length > 10) {
      value = value.slice(0, 10);
      $('#mobile').val(value);
    }else{
      if(! phoneRegex.test(mobile)){
        $("#mobErr").text('Enter a valid 10 digit mobile number')
      }else{
        $("#mobErr").text('')
      }
    }

    
    // if(mobile != ""){
      
    // }
  }

  

</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js" integrity="sha512-AA1Bzp5Q0K1KanKKmvN/4d3IRKVlv9PYgwFPvm32nPO6QS8yH1HO7LbgB1pgiOxPtfeg5zEn2ba64MUcqJx6CA==" crossorigin="anonymous" referrerpolicy="no-referrer" ></script>
{%if messages%} {%for message in messages%} {%if message.tags == "success"%}
<script>
    swal({
    position: "top-end",
    icon: "success",
    title: "{{message}}",
    });
</script>
{%elif message.tags == "warning"%}
<script>
    swal({
    position: "top-end",
    icon: "warning",
    title: "{{message}}",
    });
</script>
{%elif message.tags == "error"%}
<script>
    swal({
    position: "top-end",
    icon: "error",
    title: "{{message}}",
    });
</script>
{%else%}
<script>
    swal({
    position: "top-end",
    icon: "info",
    title: "{{message}}",
    });
</script>
{%endif%} {%endfor%} {%endif%}
</body>
</html>